---
title: Python机器学习
description: 机器学习入门 - Scikit-learn、常用算法、模型评估、实战案例（Day81-90）
date: 2026-02-10
tags:
  - python
  - machine-learning
  - scikit-learn
  - algorithms
  - model-evaluation
  - ml
category: 专业方向
status: active
direction: 数据分析
aliases:
  - 机器学习
  - Machine Learning
  - Day81-90
parent: "[[00-导航-Python编程导航]]"
up: "[[00-MOC-知识地图]]"
---

# Python机器学习 (Day 81-90)

> 了解常用机器学习算法原理和应用场景

---

## 机器学习基础

### 机器学习分类

```
监督学习
├── 分类 (Classification) - 预测离散标签
│   ├── 二分类：垃圾邮件识别
│   └── 多分类：手写数字识别
└── 回归 (Regression) - 预测连续值
    └── 房价预测

无监督学习
├── 聚类 (Clustering) - K-Means
├── 降维 (Dimensionality Reduction) - PCA
└── 关联规则

强化学习
└── 通过试错学习最优策略
```

### scikit-learn基础流程

```python
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler

# 1. 准备数据
X = data.drop('target', axis=1)
y = data['target']

# 2. 划分训练集和测试集
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# 3. 特征缩放
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

# 4. 训练模型
model = SomeModel()
model.fit(X_train_scaled, y_train)

# 5. 预测
predictions = model.predict(X_test_scaled)

# 6. 评估
from sklearn.metrics import accuracy_score
print(accuracy_score(y_test, predictions))
```

---

## 常用算法

### 1. K近邻 (KNN)

```python
from sklearn.neighbors import KNeighborsClassifier, KNeighborsRegressor

# 分类
knn = KNeighborsClassifier(n_neighbors=5)
knn.fit(X_train, y_train)
predictions = knn.predict(X_test)

# 回归
knn_reg = KNeighborsRegressor(n_neighbors=5)
knn_reg.fit(X_train, y_train)
```

### 2. 决策树和随机森林

```python
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier

# 决策树
dt = DecisionTreeClassifier(max_depth=5, random_state=42)
dt.fit(X_train, y_train)

# 随机森林
rf = RandomForestClassifier(n_estimators=100, random_state=42)
rf.fit(X_train, y_train)

# 特征重要性
importances = pd.DataFrame({
    'feature': X.columns,
    'importance': rf.feature_importances_
}).sort_values('importance', ascending=False)
```

### 3. 线性回归

```python
from sklearn.linear_model import LinearRegression, Ridge, Lasso
from sklearn.metrics import mean_squared_error, r2_score

# 线性回归
lr = LinearRegression()
lr.fit(X_train, y_train)

# 预测
y_pred = lr.predict(X_test)

# 评估
print(f"MSE: {mean_squared_error(y_test, y_pred)}")
print(f"R²: {r2_score(y_test, y_pred)}")

# 正则化
ridge = Ridge(alpha=1.0)
lasso = Lasso(alpha=0.1)
```

### 4. K-Means聚类

```python
from sklearn.cluster import KMeans

# 确定最佳K值
inertias = []
for k in range(1, 11):
    kmeans = KMeans(n_clusters=k, random_state=42)
    kmeans.fit(X)
    inertias.append(kmeans.inertia_)

# 训练模型
kmeans = KMeans(n_clusters=3, random_state=42)
clusters = kmeans.fit_predict(X)

# 聚类中心
print(kmeans.cluster_centers_)
```

---

## 模型评估

```python
from sklearn.metrics import (
    accuracy_score, precision_score, recall_score, f1_score,
    confusion_matrix, classification_report,
    roc_auc_score, roc_curve
)

# 分类指标
print(classification_report(y_test, y_pred))

# 混淆矩阵
cm = confusion_matrix(y_test, y_pred)
sns.heatmap(cm, annot=True, fmt='d')

# ROC曲线
y_pred_proba = model.predict_proba(X_test)[:, 1]
fpr, tpr, _ = roc_curve(y_test, y_pred_proba)
auc = roc_auc_score(y_test, y_pred_proba)
```

---

**下一步**: [[03-方向A-工程化实践|工程化实践]] → 学习项目部署和最佳实践
