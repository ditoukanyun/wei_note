# Python工程化实践 (Day 91-100)

> 掌握工程化开发、项目部署和面试技巧

---

## Git团队协作

```bash
# Git Flow工作流程

# 1. 创建功能分支
git checkout -b feature/user-auth develop

# 2. 开发并提交
git add .
git commit -m "feat: add user authentication"

# 3. 保持同步
git checkout develop
git pull origin develop
git checkout feature/user-auth
git rebase develop

# 4. 推送并创建PR
git push origin feature/user-auth

# 5. 合并后删除分支
git checkout develop
git merge --no-ff feature/user-auth
git push origin develop
git branch -d feature/user-auth
```

---

## Docker容器化

```dockerfile
# Dockerfile
FROM python:3.9-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 8000

CMD ["gunicorn", "--bind", "0.0.0.0:8000", "myproject.wsgi:application"]
```

```yaml
# docker-compose.yml
version: '3.8'

services:
  web:
    build: .
    ports:
      - "8000:8000"
    environment:
      - DEBUG=0
    depends_on:
      - db
      - redis
  
  db:
    image: postgres:13
    environment:
      - POSTGRES_DB=mydb
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=password
  
  redis:
    image: redis:alpine
```

---

## 性能优化

### Python优化

```python
# 1. 使用列表生成式
# 慢
result = []
for x in range(1000):
    result.append(x * 2)

# 快
result = [x * 2 for x in range(1000)]

# 2. 使用生成器节省内存
# 慢
sum([x**2 for x in range(1000000)])

# 快
sum(x**2 for x in range(1000000))

# 3. 使用缓存
from functools import lru_cache

@lru_cache(maxsize=128)
def fibonacci(n):
    if n < 2:
        return n
    return fibonacci(n-1) + fibonacci(n-2)

# 4. 使用多进程处理CPU密集型任务
from multiprocessing import Pool

with Pool(processes=4) as pool:
    results = pool.map(process_data, data_list)
```

### Django优化

```python
# 1. 数据库查询优化
# 慢
for article in Article.objects.all():
    print(article.author.name)  # N+1查询

# 快
for article in Article.objects.select_related('author'):
    print(article.author.name)

# 2. 使用缓存
from django.core.cache import cache

data = cache.get('key')
if data is None:
    data = expensive_query()
    cache.set('key', data, 300)

# 3. 数据库索引
class Article(models.Model):
    class Meta:
        indexes = [
            models.Index(fields=['-created_at']),
        ]
```

---

## 面试常见问题

### Python基础

1. **GIL是什么？**
   - 全局解释器锁，保证同一时刻只有一个线程执行Python字节码
   - 影响：多线程不能利用多核CPU

2. **装饰器是什么？**
   - 修改函数行为的高阶函数
   - 使用@语法糖

3. **列表和元组的区别？**
   - 列表可变，元组不可变
   - 元组可作为字典键
   - 元组创建更快

### Django

1. **请求处理流程？**
   - 请求 → WSGI → 中间件 → URL路由 → 视图 → 模板/响应

2. **ORM优缺点？**
   - 优点：开发效率高、可移植性强
   - 缺点：性能损耗、复杂查询受限

3. **数据库优化方法？**
   - 索引优化
   - 查询优化（避免N+1）
   - 缓存
   - 读写分离

---

## 部署配置

```nginx
# nginx.conf
server {
    listen 80;
    server_name example.com;
    
    location /static/ {
        alias /var/www/static/;
        expires 1y;
    }
    
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

**恭喜！** 已完成Python-100-Days全部课程！

**建议下一步：**
1. 完成所有实战项目
2. 阅读优秀开源项目代码
3. 参与开源贡献
4. 准备面试
